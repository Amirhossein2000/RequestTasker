version: "3"

tasks:
  generate-api:
    cmds:
      - oapi-codegen -generate types,server,strict-server,spec -package api ./openapi/api.yml > ./internal/app/api/api.gen.go
  generate-mock:
    cmds:
      - go generate ./...
  build:
    cmds:
      - go build -o ./bin ./cmd/
  test-db:
    cmds:
      - go test -v -count=1 github.com/Amirhossein2000/RequestTasker/internal/infrastructures/mysql
  test-usecase:
    cmds:
      - go test -v -count=1 github.com/Amirhossein2000/RequestTasker/internal/app/usecases
  test-kafka:
    cmds:
      - go test -v -count=1 github.com/Amirhossein2000/RequestTasker/internal/infrastructures/kafka
  test-api:
    cmds:
      - go test -v -count=1 github.com/Amirhossein2000/RequestTasker/internal/app/api/handlers
  test:
    - task: test-db
    - task: test-usecase
    - task: test-kafka
    - task: test-api
# setup dependencies

# clean dependencies

# run

# stop

# migration

# clean db

# test

# test integration
